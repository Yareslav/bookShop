{"ast":null,"code":"var _jsxFileName = \"C:\\\\My\\\\Programesoft\\\\Javascript\\\\bookshop\\\\src\\\\screens\\\\Main\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useContext, useEffect, createContext } from \"react\";\nimport \"../../assets/styles/main.css\";\nimport { SearchContext } from \"../../App\";\nimport OfferBooks from \"./components/OfferBooks\";\nimport Article from \"./components/Article\";\nimport SearchResults from \"./components/SearchResults\";\nimport fetcher from \"../../functions/fetcher\";\nimport compare from \"../../functions/compare\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const SortContext = /*#__PURE__*/createContext();\n\nconst CreateMainScreen = _ref => {\n  _s();\n\n  let {\n    showArticle\n  } = _ref;\n  const {\n    searchActive\n  } = useContext(SearchContext);\n  const [foundItems, setFoundItems] = useState([]);\n  const [bookView, setBookView] = useState(\"normal\");\n  const [nothingFound, setNothingFound] = useState(false);\n  const [sortedItems, setSortedItems] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const sortOptions = {\n    disabled: \"disabled\",\n    ascending: \"ascending\",\n    descending: \"descending\"\n  };\n  const [sorting, setSorting] = useState({\n    money: sortOptions.disabled,\n    rating: sortOptions.disabled,\n    date: sortOptions.disabled\n  });\n\n  class Sort {\n    constructor() {\n      let entries = Object.entries(sorting);\n      const sortedData = [...foundItems];\n      entries = entries.filter(elem => elem[1] != sortOptions.disabled);\n      setSortedItems([]);\n      if (entries.length == 0) return;\n      const type = entries[0][0],\n            mode = entries[0][1];\n      const getCount = this.count.bind(null, type);\n      sortedData.sort((curr, next) => {\n        if (type == \"date\") {\n          const comparedDate = this.compareDateInAscendingMode(curr, next);\n          if (mode == sortOptions.ascending) return comparedDate;\n          return -comparedDate;\n        }\n\n        if (mode == sortOptions.ascending) return getCount(curr) - getCount(next);else return getCount(next) - getCount(curr);\n      });\n      setSortedItems([...sortedData]);\n    }\n\n    compareDateInAscendingMode(curr, next) {\n      let currDate = curr.publishedDate;\n      let nextDate = next.publishedDate;\n      if (currDate == \"Unknown\") return -1;\n      if (nextDate == \"Unknown\") return 1;\n      currDate = currDate.split(\"-\");\n      nextDate = nextDate.split(\"-\");\n      const currentYear = +currDate[0],\n            nextYear = +nextDate[0];\n      if (currDate.length == 1 || nextDate.length == 1 || currentYear != nextYear) return currentYear - nextYear;\n      const currentMonth = +currDate[1],\n            nextMonth = +nextDate[1];\n      if (currentMonth != nextMonth) return currentMonth - nextMonth;\n      const currentDay = +currDate[2],\n            nextDay = +nextDate[2];\n      return currentDay - nextDay;\n    }\n\n    count(type, obj) {\n      if (type == \"money\") {\n        if (obj.canBeBought) return +obj.listPrice.split(\" \")[0];\n        return 0;\n      }\n\n      if (type == \"rating\") return obj.rating;\n    }\n\n  }\n\n  useEffect(() => {\n    new Sort();\n  }, [...Object.values(sorting), loading]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main beet\",\n    children: /*#__PURE__*/_jsxDEV(SortContext.Provider, {\n      value: {\n        sorting,\n        setSorting,\n        sortOptions\n      },\n      children: [showArticle && /*#__PURE__*/_jsxDEV(Article, {\n        setFoundItems,\n        foundItems,\n        setBookView,\n        bookView,\n        nothingFound,\n        setNothingFound,\n        setLoading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"main__body\",\n        children: searchActive ? /*#__PURE__*/_jsxDEV(SearchResults, {\n          foundItems,\n          bookView,\n          nothingFound,\n          sortedItems,\n          loading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this) : /*#__PURE__*/_jsxDEV(OfferBooks, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 5\n  }, this);\n};\n\n_s(CreateMainScreen, \"7ZkBsgsViMROnsH4UJh9go/P0rA=\");\n\n_c = CreateMainScreen;\nexport default CreateMainScreen;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreateMainScreen\");","map":{"version":3,"sources":["C:/My/Programesoft/Javascript/bookshop/src/screens/Main/index.js"],"names":["React","useState","useContext","useEffect","createContext","SearchContext","OfferBooks","Article","SearchResults","fetcher","compare","SortContext","CreateMainScreen","showArticle","searchActive","foundItems","setFoundItems","bookView","setBookView","nothingFound","setNothingFound","sortedItems","setSortedItems","loading","setLoading","sortOptions","disabled","ascending","descending","sorting","setSorting","money","rating","date","Sort","constructor","entries","Object","sortedData","filter","elem","length","type","mode","getCount","count","bind","sort","curr","next","comparedDate","compareDateInAscendingMode","currDate","publishedDate","nextDate","split","currentYear","nextYear","currentMonth","nextMonth","currentDay","nextDay","obj","canBeBought","listPrice","values"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect, createContext } from \"react\";\r\nimport \"../../assets/styles/main.css\";\r\nimport { SearchContext } from \"../../App\";\r\nimport OfferBooks from \"./components/OfferBooks\";\r\nimport Article from \"./components/Article\";\r\nimport SearchResults from \"./components/SearchResults\";\r\nimport fetcher from \"../../functions/fetcher\";\r\nimport compare from \"../../functions/compare\";\r\nexport const SortContext = createContext();\r\nconst CreateMainScreen = ({showArticle}) => {\r\n  const { searchActive } = useContext(SearchContext);\r\n  const [foundItems, setFoundItems] = useState([]);\r\n  const [bookView, setBookView] = useState(\"normal\");\r\n  const [nothingFound, setNothingFound] = useState(false);\r\n  const [sortedItems, setSortedItems] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const sortOptions = {\r\n    disabled: \"disabled\",\r\n    ascending: \"ascending\",\r\n    descending: \"descending\",\r\n  };\r\n  const [sorting, setSorting] = useState({\r\n    money: sortOptions.disabled,\r\n    rating: sortOptions.disabled,\r\n    date: sortOptions.disabled,\r\n  });\r\n  class Sort {\r\n    constructor() {\r\n      let entries = Object.entries(sorting);\r\n      const sortedData = [...foundItems];\r\n      entries = entries.filter((elem) => elem[1] != sortOptions.disabled);\r\n      setSortedItems([]);\r\n      if (entries.length == 0) return;\r\n        const type = entries[0][0] , mode=entries[0][1];\r\n        const getCount = this.count.bind(null, type);\r\n        sortedData.sort((curr, next) => {\r\n          if (type==\"date\") {\r\n            const comparedDate=this.compareDateInAscendingMode(curr,next);\r\n            if (mode==sortOptions.ascending) return comparedDate;\r\n            return -comparedDate;\r\n          }\r\n          if (mode == sortOptions.ascending) return getCount(curr) - getCount(next);\r\n          else return getCount(next) - getCount(curr);\r\n        });\r\n      setSortedItems([...sortedData]);\r\n    }\r\n    compareDateInAscendingMode(curr, next) {\r\n      let currDate = curr.publishedDate;\r\n      let nextDate = next.publishedDate;\r\n      if (currDate == \"Unknown\") return -1;\r\n      if (nextDate == \"Unknown\") return 1;\r\n      currDate = currDate.split(\"-\");\r\n      nextDate = nextDate.split(\"-\");\r\n      const currentYear = +currDate[0],\r\n        nextYear = +nextDate[0];\r\n      if (\r\n        currDate.length == 1 ||\r\n        nextDate.length == 1 ||\r\n        currentYear != nextYear\r\n      )\r\n        return currentYear - nextYear;\r\n      const currentMonth = +currDate[1],\r\n        nextMonth = +nextDate[1];\r\n      if (currentMonth != nextMonth) return currentMonth - nextMonth;\r\n      const currentDay = +currDate[2],\r\n        nextDay = +nextDate[2];\r\n      return currentDay - nextDay;\r\n    }\r\n    count(type, obj) {\r\n      if (type == \"money\") {\r\n        if (obj.canBeBought) return +obj.listPrice.split(\" \")[0];\r\n        return 0;\r\n      }\r\n      if (type == \"rating\") return obj.rating;\r\n    }\r\n  }\r\n  useEffect(()=>{\r\n    new Sort();\r\n  },[...Object.values(sorting),loading]);\r\n\r\n  return (\r\n    <div className=\"main beet\">\r\n      <SortContext.Provider value={{ sorting, setSorting, sortOptions}}>\r\n        {showArticle && <Article\r\n          {...{\r\n            setFoundItems,\r\n            foundItems,\r\n            setBookView,\r\n            bookView,\r\n            nothingFound,\r\n            setNothingFound,\r\n            setLoading\r\n          }}\r\n        />}\r\n      <div className=\"main__body\">\r\n        {searchActive ? (\r\n          <SearchResults\r\n            {...{ foundItems, bookView, nothingFound, sortedItems, loading }}\r\n          />\r\n        ) : (\r\n          <OfferBooks />\r\n        )}\r\n      </div>\r\n      </SortContext.Provider>\r\n    </div>\r\n  );\r\n};\r\nexport default CreateMainScreen;"]},"metadata":{},"sourceType":"module"}